<div class="material-wizard-container">
  <div class="wizard-header">
    <div class="header-content">
      <div class="header-title">
        <h1>Material & Loading Properties</h1>
        <p>{{selectedSlabPanelProperty.name}}</p>
      </div>
      <div class="progress-indicator">
        <div class="progress-step active">
          <span class="step-number">1</span>
          <span class="step-label">Materials</span>
        </div>
        <div class="progress-step">
          <span class="step-number">2</span>
          <span class="step-label">Loading</span>
        </div>
        <div class="progress-step">
          <span class="step-number">3</span>
          <span class="step-label">Review</span>
        </div>
      </div>
    </div>
  </div>

  <div class="wizard-body">
    <form [formGroup]="mtpForm">
      <aw-wizard [navBarLayout]="'large-empty-symbols'" class="modern-wizard">

        <!-- Step 1: Materials -->
        <aw-wizard-step stepTitle="Materials">
          <ng-template awWizardStepSymbol>
            <i class="bx bx-cube"></i>
          </ng-template>
          
          <div class="step-container">
            <div class="step-intro">
              <h2>Material Properties</h2>
            </div>
            
            <!-- Concrete Properties -->
            <div class="property-section">
              <div class="section-header">
                <h3>Concrete Properties</h3>
                    </div>
              
              <div class="properties-grid">
                <div class="property-card">
                  <label for="concreteStrength">Concrete Strength</label>
                  <div class="input-wrapper">
                    <input type="number" id="concreteStrength" formControlName="concrete_strength" 
                           placeholder="25.00" class="form-control">
                    <span class="unit">N/mm²</span>
                  </div>
                    </div>
                
                <div class="property-card">
                  <label for="concreteDensity">Density</label>
                  <div class="input-wrapper">
                    <input type="number" id="concreteDensity" formControlName="concrete_density" 
                           placeholder="24.00" class="form-control">
                    <span class="unit">kN/m³</span>
                  </div>
                </div>

                <div class="property-card">
                  <label for="concreteSteelCover">Steel Cover</label>
                  <div class="input-wrapper">
                    <input type="number" id="concreteSteelCover" formControlName="concrete_steel_cover" 
                           placeholder="25.00" class="form-control">
                    <span class="unit">mm</span>
                  </div>
                    </div>
                
                <div class="property-card">
                  <label for="concreteWcRatio">Water-Cement Ratio</label>
                  <div class="input-wrapper">
                    <input type="number" id="concreteWcRatio" formControlName="concrete_wc_ratio" 
                           placeholder="0.500" class="form-control">
                    <span class="unit">-</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Steel Properties -->
            <div class="property-section">
              <div class="section-header">
                <h3>Steel Reinforcement Properties</h3>
              </div>
              
              <div class="properties-grid">
                <div class="property-card">
                  <label for="steelStrength">Steel Strength</label>
                  <div class="input-wrapper">
                    <input type="number" id="steelStrength" formControlName="steel_strength" 
                           placeholder="460" class="form-control">
                    <span class="unit">N/mm²</span>
                  </div>
                    </div>
                
                <div class="property-card">
                  <label for="steelDensity">Steel Density</label>
                  <div class="input-wrapper">
                    <input type="number" id="steelDensity" formControlName="steel_density" 
                           placeholder="78.50" class="form-control">
                    <span class="unit">kN/m³</span>
                  </div>
                </div>
              </div>
              
              <!-- Reinforcement Sizing -->
              <div class="reinforcement-grid">
                <div class="reinforcement-section">
                  <h4>Bottom Reinforcement</h4>
                  <div class="sizing-grid">
                    <div class="sizing-card">
                      <label>Primary Size</label>
                      <select formControlName="steel_bott1_size" class="form-select">
                        <option value="">Select Size</option>
                        <option [value]="item" *ngFor="let item of botTopSize">{{item}} mm</option>
                      </select>
                    </div>
                    <div class="sizing-card">
                      <label>Primary Spacing</label>
                      <select formControlName="steel_bott1_gap" class="form-select">
                        <option value="">Select Spacing</option>
                        <option [value]="item" *ngFor="let item of botTopGap">{{item}} mm</option>
                      </select>
                    </div>
                    <div class="sizing-card">
                      <label>Secondary Size</label>
                      <select formControlName="steel_bott2_size" class="form-select">
                        <option value="">Select Size</option>
                        <option [value]="item" *ngFor="let item of botTopSize">{{item}} mm</option>
                      </select>
                    </div>
                    <div class="sizing-card">
                      <label>Secondary Spacing</label>
                      <select formControlName="steel_bott2_gap" class="form-select">
                        <option value="">Select Spacing</option>
                        <option [value]="item" *ngFor="let item of botTopGap">{{item}} mm</option>
                      </select>
                    </div>
                  </div>
                </div>

                <div class="reinforcement-section">
                  <h4>Top Reinforcement</h4>
                  <div class="sizing-grid">
                    <div class="sizing-card">
                      <label>Primary Size</label>
                      <select formControlName="steel_top1_size" class="form-select">
                        <option value="">Select Size</option>
                        <option [value]="item" *ngFor="let item of botTopSize">{{item}} mm</option>
                      </select>
                    </div>
                    <div class="sizing-card">
                      <label>Primary Spacing</label>
                      <select formControlName="steel_top1_gap" class="form-select">
                        <option value="">Select Spacing</option>
                        <option [value]="item" *ngFor="let item of botTopGap">{{item}} mm</option>
                      </select>
                    </div>
                    <div class="sizing-card">
                      <label>Secondary Size</label>
                      <select formControlName="steel_top2_size" class="form-select">
                        <option value="">Select Size</option>
                        <option [value]="item" *ngFor="let item of botTopSize">{{item}} mm</option>
                      </select>
                    </div>
                    <div class="sizing-card">
                      <label>Secondary Spacing</label>
                      <select formControlName="steel_top2_gap" class="form-select">
                        <option value="">Select Spacing</option>
                        <option [value]="item" *ngFor="let item of botTopGap">{{item}} mm</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="step-actions">
            <button type="button" class="btn btn-primary btn-next" awNextStep>
              Continue to Loading
            </button>
          </div>
            </aw-wizard-step>

        <!-- Step 2: Loading -->
        <aw-wizard-step stepTitle="Loading">
          <ng-template awWizardStepSymbol>
            <i class="bx bx-weight"></i>
          </ng-template>
          
          <div class="step-container">
            <div class="step-intro">
              <h2>Loading Configuration</h2>
            </div>

            <!-- Dead Loading -->
            <div class="property-section">
              <div class="section-header">
                <h3>Dead Loading</h3>
              </div>
              
              <div class="properties-grid">
                <div class="property-card">
                  <label for="deadLoadingFinishes">Floor Finishes</label>
                  <div class="input-wrapper">
                    <input type="number" id="deadLoadingFinishes" formControlName="dead_loading_finishes" 
                           placeholder="25.00" class="form-control">
                    <span class="unit">kN/m²</span>
                  </div>
                    </div>
                
                <div class="property-card">
                  <label for="deadLoadingPartition">Partitions</label>
                  <div class="input-wrapper">
                    <input type="number" id="deadLoadingPartition" formControlName="dead_loading_partition" 
                           placeholder="25.00" class="form-control">
                    <span class="unit">kN/m²</span>
                  </div>
                </div>

                <div class="property-card">
                  <label for="deadLoadingServices">Services</label>
                  <div class="input-wrapper">
                    <input type="number" id="deadLoadingServices" formControlName="dead_loading_services" 
                           placeholder="24.00" class="form-control">
                    <span class="unit">kN/m²</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Live Loading -->
            <div class="property-section">
              <div class="section-header">
                <h3>Live Loading</h3>
                    </div>
              
              <div class="properties-grid">
                <div class="property-card">
                  <label for="liveLoadingImposed">Imposed Load</label>
                  <div class="input-wrapper">
                    <input type="number" id="liveLoadingImposed" formControlName="live_loading_imposed" 
                           placeholder="24.00" class="form-control">
                    <span class="unit">kN/m²</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="step-actions">
            <button type="button" class="btn btn-light btn-prev" awPreviousStep>
              Back to Materials
            </button>
            <button type="button" class="btn btn-primary btn-next" awNextStep>
              Review & Save
            </button>
          </div>
        </aw-wizard-step>

        <!-- Step 3: Review -->
        <aw-wizard-step stepTitle="Review">
          <ng-template awWizardStepSymbol>
            <i class="bx bx-check-circle"></i>
          </ng-template>
          
          <div class="step-container">
            <div class="step-intro">
              <h2>Review & Confirm</h2>
                  </div>

            <div class="review-grid">
              <!-- Panel Summary -->
              <div class="review-card">
                <div class="card-header">
                  <h3>Panel Summary</h3>
                </div>
                <div class="card-content">
                  <div class="summary-item">
                    <span class="label">Panel Name</span>
                    <span class="value">{{selectedSlabPanelProperty.name}}</span>
                  </div>
                  <div class="summary-item">
                    <span class="label">Support Type</span>
                    <span class="value">{{selectedSlabPanelProperty.panel_support.name}}</span>
                  </div>
                  <div class="summary-item">
                    <span class="label">Dimensions</span>
                    <span class="value">{{selectedSlabPanelProperty.long_length}} × {{selectedSlabPanelProperty.short_length}} × {{selectedSlabPanelProperty.thickness}} mm</span>
                  </div>
                </div>
              </div>

              <!-- Material Summary -->
              <div class="review-card">
                <div class="card-header">
                  <h3>Material Properties</h3>
                </div>
                <div class="card-content">
                  <div class="summary-section">
                    <h4>Concrete</h4>
                    <div class="summary-item">
                      <span class="label">Strength</span>
                      <span class="value">{{mtpForm.value.concrete_strength}} N/mm²</span>
                    </div>
                    <div class="summary-item">
                      <span class="label">Density</span>
                      <span class="value">{{mtpForm.value.concrete_density}} kN/m³</span>
                    </div>
                    <div class="summary-item">
                      <span class="label">Cover</span>
                      <span class="value">{{mtpForm.value.concrete_steel_cover}} mm</span>
                    </div>
                  </div>
                  <div class="summary-section">
                    <h4>Steel</h4>
                    <div class="summary-item">
                      <span class="label">Strength</span>
                      <span class="value">{{mtpForm.value.steel_strength}} N/mm²</span>
                    </div>
                    <div class="summary-item">
                      <span class="label">Density</span>
                      <span class="value">{{mtpForm.value.steel_density}} kN/m³</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Loading Summary -->
              <div class="review-card">
                <div class="card-header">
                  <h3>Loading Properties</h3>
                </div>
                <div class="card-content">
                  <div class="summary-section">
                    <h4>Dead Loads</h4>
                    <div class="summary-item">
                      <span class="label">Finishes</span>
                      <span class="value">{{mtpForm.value.dead_loading_finishes}} kN/m²</span>
                    </div>
                    <div class="summary-item">
                      <span class="label">Partitions</span>
                      <span class="value">{{mtpForm.value.dead_loading_partition}} kN/m²</span>
                    </div>
                    <div class="summary-item">
                      <span class="label">Services</span>
                      <span class="value">{{mtpForm.value.dead_loading_services}} kN/m²</span>
                    </div>
                  </div>
                  <div class="summary-section">
                    <h4>Live Loads</h4>
                    <div class="summary-item">
                      <span class="label">Imposed</span>
                      <span class="value">{{mtpForm.value.live_loading_imposed}} kN/m²</span>
                    </div>
                    </div>
                  </div>
                </div>

              <!-- Results (if available) -->
              <div class="review-card" *ngIf="selectedMaterialLoadingProperty?.id>0">
                <div class="card-header">
                  <h3>Analysis Results</h3>
                </div>
                <div class="card-content">
                  <div class="results-table">
                    <div class="result-header">
                      <span>Moment Type</span>
                      <span>Short Span</span>
                      <span>Long Span</span>
                    </div>
                    <div class="result-row">
                      <span>Negative (Continuous Edge)</span>
                      <span class="value">{{selectedMaterialLoadingProperty.negative_short_span | number:'1.3-3'}}</span>
                      <span class="value">{{selectedMaterialLoadingProperty.negative_long_span | number:'1.3-3'}}</span>
                    </div>
                    <div class="result-row">
                      <span>Positive (Mid-Span)</span>
                      <span class="value">{{selectedMaterialLoadingProperty.positive_short_span | number:'1.3-3'}}</span>
                      <span class="value">{{selectedMaterialLoadingProperty.positive_long_span | number:'1.3-3'}}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="step-actions">
            <button type="button" class="btn btn-light btn-prev" awPreviousStep>
              Back to Loading
            </button>
            <button type="submit" class="btn btn-success btn-save" 
                    [ladda]="loading" (click)="submitMaterialProperties(mtpForm.value)">
              Save Properties
            </button>
          </div>
          
          <!-- Alerts -->
          <div class="alerts-section">
            <ngb-alert type="success" *ngIf="successmsg" [dismissible]="false">
              {{successmsg}}
            </ngb-alert>
            <ngb-alert type="danger" *ngIf="error" [dismissible]="false">
              {{ error }}
            </ngb-alert>
          </div>
            </aw-wizard-step>
          </aw-wizard>
      </form>
  </div>
</div>
